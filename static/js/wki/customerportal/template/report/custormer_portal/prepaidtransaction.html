{% extends 'report/custormer_portal/base.html' %}



{% block content %}
<style type="text/css">
  .layout-warning.bordered {
    border: 2px solid #571fbd;
}
.btn-secondary {
    color: #fff;
    background-color: #571fbd;
    border-color: #6c757d;
}
</style>
<div class="wrapper-content">
 <div class="container">

        <!-- START: Main Content-->
                <!-- START: Breadcrumbs-->
                <div class="row ">
                    <div class="col-12  align-self-center">
                        <div class="sub-header mt-3 py-3 px-3 align-self-center d-sm-flex w-100 rounded">
                            <div class="w-sm-100 mr-auto"><h4 class="mb-0">Prepaid Transactions</h4></div>

                            <ol class="breadcrumb bg-transparent align-self-center m-0 p-0">
                                <li class="breadcrumb-item"><a href="">Home</a></li>
                                <li class="breadcrumb-item"><a href="">Table</a></li>
                                <li class="breadcrumb-item active"><a href="">Prepaid Transactions</a></li>
                            </ol>
                        </div>
                    </div>
                </div>
                <!-- END: Breadcrumbs-->

                <!-- START: Card Data-->
                <div class="row">
                    <div class="col-12 mt-3">
                        <div class="card">
                            <div class="card-header  justify-content-between align-items-center">                               
                                <h4 class="card-title">Prepaid Transactionse</h4>
                               
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="payments" datas='[
            { "data": "created" },
            { "data": "transaction" },
            { "data": "amount" },
            { "data": "ststoken" },
            { "data": "units" },
            { "data": "unit" },
            { "data": "arrears" }
                  

        ]' class="table layout-warning bordered" query="select created,transaction,concat('â‚¦',ROUND(cast(amount as numeric) ,2)) as amount,ststoken,concat(ROUND(cast(units as numeric) ,2)) as units,unit,arrears from prepaid_trans where user_t = {{request.session.acc_id}}">
                                        <thead style="color: #fff; background:#571fbd;">
                                           <tr>
                                            <th style="color: #fff; background:#571fbd;">Created </th>
                                            <th style="color: #fff; background:#571fbd;">Transaction ID</th>
                                            <th style="color: #fff; background:#571fbd;">Amount</th>
                                            <th style="color: #fff; background:#571fbd;">Token</th>
                                            <th style="color: #fff; background:#571fbd;">Units</th>
                                            <th style="color: #fff; background:#571fbd;">Unit</th>
                                            <th style="color: #fff; background:#571fbd;">Arrears</th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div> 

                    </div>                  
                </div>
                <!-- END: Card DATA-->
            
       
        <!-- END: Content-->
<!-- <div class="col-sm-16">
        <div class="card">
          <div class="card-header">
            <h6 class="card-title">Prepaid Transactions Chart</h6>
          </div>
        

<script src="https://www.amcharts.com/lib/4/core.js"></script>
<script src="https://www.amcharts.com/lib/4/charts.js"></script>
<script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>



      <div id="chartdiv3"  style=" height: 390px;"></div>



        </div>
      </div> -->
</div>
{% endblock %}

 

<!-- jQuery first, then Tether, then Bootstrap JS. -->

<script src="../js/jquery-2.1.1.min.js" type="text/javascript"></script>

<script src="../../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script> 

<script src="../vendor/bootstrap4beta/js/bootstrap.min.js" type="text/javascript"></script> 

<!--Cookie js for theme chooser and applying it --> 
<script src="../vendor/cookie/jquery.cookie.js"  type="text/javascript"></script> 

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug --> <script src="../js/ie10-viewport-bug-workaround.js"></script> 

<!-- Circular chart progress js --> 
<script src="../vendor/cicular_progress/circle-progress.min.js" type="text/javascript"></script> 
<!--sparklines js--> 
<script type="text/javascript" src="../vendor/sparklines/jquery.sparkline.min.js"></script> 

<!-- DataTables JavaScript --> 
<script src="../vendor/datatables/js/jquery.dataTables.min.js"></script> 
<script src="../vendor/datatables/js/dataTables.bootstrap4.js"></script> 
<script src="../vendor/datatables/js/dataTables.responsive.min.js"></script> 
    

<!-- custome template js --> 
<script src="../js/adminux.js" type="text/javascript"></script> 


<script>
      "use strict";
    $(document).on('ready', function() {
                $('#dataTables-example').DataTable({
                        responsive: true,
                        pageLength:10,
                        sPaginationType: "full_numbers",
                        oLanguage: {
                            oPaginate: {
                                sFirst: "<<",
                                sPrevious: "<",
                                sNext: ">", 
                                sLast: ">>" 
                            }
                        }
                    });
            });


  /**
 * ---------------------------------------
 * This demo was created using amCharts 4.
 * 
 * For more information visit:
 * https://www.amcharts.com/
 * 
 * Documentation is available at:
 * https://www.amcharts.com/docs/v4/
 * ---------------------------------------
 */

// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end

// Create chart instance
var chart = am4core.create("chartdiv", am4charts.XYChart3D);

// Add data
chart.data = [{
  "country": "NIGERIA",
  "visits": 4025,
  "color": chart.colors.next()
}, {
  "country": "China",
  "visits": 1882,
  "color": chart.colors.next()
}, {
  "country": "Japan",
  "visits": 1809,
  "color": chart.colors.next()
}, {
  "country": "Germany",
  "visits": 1322,
  "color": chart.colors.next()
}, {
  "country": "UK",
  "visits": 4025,
  "color": chart.colors.next()
}, {
  "country": "France",
  "visits": 1114,
  "color": chart.colors.next()
}, {
  "country": "India",
  "visits": 984,
  "color": chart.colors.next()
}, {
  "country": "Spain",
  "visits": 711,
  "color": chart.colors.next()
}, {
  "country": "Netherlands",
  "visits": 665,
  "color": chart.colors.next()
}, {
  "country": "Russia",
  "visits": 580,
  "color": chart.colors.next()
}, {
  "country": "South Korea",
  "visits": 443,
  "color": chart.colors.next()
}, {
  "country": "Canada",
  "visits": 441,
  "color": chart.colors.next()
}, {
  "country": "Brazil",
  "visits": 395,
  "color": chart.colors.next()
}, {
  "country": "Italy",
  "visits": 3025,
  "color": chart.colors.next()
}, {
  "country": "Australia",
  "visits": 389,
  "color": chart.colors.next()
}, {
  "country": "Taiwan",
  "visits": 402,
  "color": chart.colors.next()
}, {
  "country": "Poland",
  "visits": 328,
  "color": chart.colors.next()
}];

// Create axes
var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
categoryAxis.dataFields.category = "country";
categoryAxis.renderer.labels.template.rotation = 270;
categoryAxis.renderer.labels.template.hideOversized = false;
categoryAxis.renderer.minGridDistance = 20;
categoryAxis.renderer.labels.template.horizontalCenter = "right";
categoryAxis.renderer.labels.template.verticalCenter = "middle";
categoryAxis.tooltip.label.rotation = 270;
categoryAxis.tooltip.label.horizontalCenter = "right";
categoryAxis.tooltip.label.verticalCenter = "middle";

var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
valueAxis.title.text = "Prepaid Transactions Chart";
valueAxis.title.fontWeight = "bold";

// Create series
var series = chart.series.push(new am4charts.ColumnSeries3D());
series.dataFields.valueY = "visits";
series.dataFields.categoryX = "country";
series.name = "Visits";
series.tooltipText = "{categoryX}: [bold]{valueY}[/]";
series.columns.template.fillOpacity = .8;
series.columns.template.propertyFields.fill = "color";

var columnTemplate = series.columns.template;
columnTemplate.strokeWidth = 2;
columnTemplate.strokeOpacity = 1;
columnTemplate.stroke = am4core.color("#FFFFFF");

chart.cursor = new am4charts.XYCursor();
chart.cursor.lineX.strokeOpacity = 0;
chart.cursor.lineY.strokeOpacity = 0;

// Enable export
chart.exporting.menu = new am4core.ExportMenu();  
        </script>




<!-- Chart code -->
<script>
  function getMonthABBR(month) {
   let monthAbbR = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
   return monthAbbR[(month - 1)]
  }
am4core.ready(function() {

// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end

// Create chart instance
var chart = am4core.create("chartdiv3", am4charts.XYChart3D);

let e = [];
{% for p in pay %}
e.push({"visits": Math.round("{{p.amount}}"),"country": getMonthABBR(parseInt("{{p.paydate}}"))});
console.log("{{p.payear}}")

{%endfor%}

// Add data
chart.data = e.reverse();
// Add data
// chart.data = [{
//   "country": "USA",
//   "visits": 4025
// }, {
//   "country": "China",
//   "visits": 1882
// }, {
//   "country": "Japan",
//   "visits": 1809
// }, {
//   "country": "Germany",
//   "visits": 1322
// }, {
//   "country": "UK",
//   "visits": 1122
// }, {
//   "country": "France",
//   "visits": 1114
// }, {
//   "country": "India",
//   "visits": 984
// }, {
//   "country": "Spain",
//   "visits": 711
// }, {
//   "country": "Netherlands",
//   "visits": 665
// }, {
//   "country": "Russia",
//   "visits": 580
// }, {
//   "country": "South Korea",
//   "visits": 443
// }, {
//   "country": "Canada",
//   "visits": 441
// }, {
//   "country": "Brazil",
//   "visits": 395
// }, {
//   "country": "Italy",
//   "visits": 386
// }, {
//   "country": "Australia",
//   "visits": 384
// }, {
//   "country": "Taiwan",
//   "visits": 338
// }, {
//   "country": "Poland",
//   "visits": 328
// }];

// Create axes
let categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
categoryAxis.dataFields.category = "country";
categoryAxis.renderer.labels.template.rotation = 270;
categoryAxis.renderer.labels.template.hideOversized = false;
categoryAxis.renderer.minGridDistance = 20;
categoryAxis.renderer.labels.template.horizontalCenter = "right";
categoryAxis.renderer.labels.template.verticalCenter = "middle";
categoryAxis.tooltip.label.rotation = 270;
categoryAxis.tooltip.label.horizontalCenter = "right";
categoryAxis.tooltip.label.verticalCenter = "middle";

let valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
valueAxis.title.text = "Payment";
valueAxis.title.fontWeight = "bold";

// Create series
var series = chart.series.push(new am4charts.ColumnSeries3D());
series.dataFields.valueY = "visits";
series.dataFields.categoryX = "country";
series.name = "Visits";
series.tooltipText = "{categoryX}: [bold]{valueY}[/]";
series.columns.template.fillOpacity = .8;

var columnTemplate = series.columns.template;
columnTemplate.strokeWidth = 2;
columnTemplate.strokeOpacity = 1;
columnTemplate.stroke = am4core.color("#FFFFFF");

columnTemplate.adapter.add("fill", function(fill, target) {
  return chart.colors.getIndex(target.dataItem.index);
})

columnTemplate.adapter.add("stroke", function(stroke, target) {
  return chart.colors.getIndex(target.dataItem.index);
})

chart.cursor = new am4charts.XYCursor();
chart.cursor.lineX.strokeOpacity = 0;
chart.cursor.lineY.strokeOpacity = 0;

}); // end am4core.ready()
</script>


</body>

</html>